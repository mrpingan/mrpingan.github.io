<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://mrpingan.github.io</id>
    <title>Ping&apos;s Home</title>
    <updated>2020-03-10T03:49:47.394Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://mrpingan.github.io"/>
    <link rel="self" href="https://mrpingan.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://mrpingan.github.io/images/avatar.png</logo>
    <icon>https://mrpingan.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Ping&apos;s Home</rights>
    <entry>
        <title type="html"><![CDATA[ubuntu å®‰è£…es]]></title>
        <id>https://mrpingan.github.io/post/ubuntu-an-zhuang-es</id>
        <link href="https://mrpingan.github.io/post/ubuntu-an-zhuang-es">
        </link>
        <updated>2020-03-10T03:47:08.000Z</updated>
        <content type="html"><![CDATA[<p>ä½¿ç”¨dpkgå®‰è£…esçš„æ—¶å€™ï¼Œå‘ç°<code>/etc/elasticserach</code>ç›®å½•ä¸‹ä¸€ç›´æ²¡æœ‰é…ç½®æ–‡ä»¶ã€‚é‡æ–°å®‰è£…ä¹Ÿæ˜¯è¿™æ ·ã€‚</p>
<pre><code># å¯ä»¥å°è¯•å…¨éƒ¨æ¸…é™¤é…ç½®æ–‡ä»¶
dpkg -P package_name
</code></pre>
<p>ç„¶åé‡æ–°å®‰è£…ï¼Œé¡ºåˆ©å®Œæˆ</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[apolloç¬”è®°]]></title>
        <id>https://mrpingan.github.io/post/apollo-bi-ji</id>
        <link href="https://mrpingan.github.io/post/apollo-bi-ji">
        </link>
        <updated>2020-02-12T07:02:44.000Z</updated>
        <content type="html"><![CDATA[<p>apolloæ˜¯æºç¨‹å¼€æºçš„é…ç½®ä¸­å¿ƒç»„ä»¶ã€‚å¯ä»¥å°†é…ç½®é›†ä¸­æ”¾ç½®ï¼Œå¹¶åœ¨é…ç½®å˜æ›´åæ¨é€ç»™åº”ç”¨ï¼Œå®ç°ä¿®æ”¹é…ç½®æ— éœ€é‡å¯æœåŠ¡ï¼Œè€Œä¸”é…ç½®æœ‰ç‰ˆæœ¬æ§åˆ¶ï¼Œå¯å›æ»šã€‚</p>
<h1 id="ä¸ºä»€ä¹ˆè¦å¼•å…¥apollo">ä¸ºä»€ä¹ˆè¦å¼•å…¥Apollo</h1>
<p>1ã€æ¥å…¥apolloå¯ä»¥è®©é…ç½®é›†ä¸­æ”¾ç½®ï¼Œé…ç½®çƒ­æ›´æ–°ï¼ŒæœåŠ¡æ— éœ€é‡å¯ã€‚<br>
2ã€æ¥å…¥apolloæ›´å®‰å…¨ã€‚é…ç½®å¦‚æœæ”¾åœ¨æœåŠ¡æºç ä¸­ï¼Œå¦‚æœæœåŠ¡æºç æ³„éœ²ï¼Œé…ç½®ä¹Ÿä¼šéšç€æ³„éœ²ã€‚<br>
å‚è€ƒæ–‡ç« ï¼šhttp://beckjin.com/2019/07/14/apollo-distributed/<br>
https://www.infoq.cn/article/ctrip-apollo-configuration-center-architecture</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[rabbitmqé›†ç¾¤éƒ¨åˆ†æ–‡æ¡£]]></title>
        <id>https://mrpingan.github.io/post/rabbitmq-ji-qun-bu-fen-wen-dang</id>
        <link href="https://mrpingan.github.io/post/rabbitmq-ji-qun-bu-fen-wen-dang">
        </link>
        <updated>2020-02-11T14:52:51.000Z</updated>
        <content type="html"><![CDATA[<p>ä¸€ä¸ªRabbitMQé›†ç¾¤æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªrabbitmqå•æœºèŠ‚ç‚¹é€»è¾‘ä¸Šçš„ç»„ã€‚æ¯ä¸€ä¸ªæˆå‘˜å…±äº«users,virtual hosts,queues,exchanges,bindings,runtime parameterså’Œå…¶ä»–åˆ†å¸ƒå¼çš„çŠ¶æ€ã€‚</p>
<h1 id="é›†ç¾¤å‘ç°">é›†ç¾¤å‘ç°</h1>
<p>ä¸€ä¸ªRabbitMQå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ„å»º</p>
<ul>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡æ˜èŠ‚ç‚¹</li>
<li>é€šè¿‡åŸºäºDNSè§£æä¸ºIP</li>
<li>ä½¿ç”¨AWS(EC2) instance discoveryï¼ˆéœ€è¦é€šè¿‡æ’ä»¶ï¼‰</li>
<li>é€šè¿‡åŸºäºconsul discoveryï¼ˆéœ€è¦é€šè¿‡æ’ä»¶ï¼‰</li>
<li>é€šè¿‡etcdï¼ˆéœ€è¦é€šè¿‡æ’ä»¶ï¼‰</li>
<li>é€šè¿‡<code>rabbitmqctl</code>æ‰‹åŠ¨æŒ‡å®š</li>
</ul>
<h2 id="èŠ‚ç‚¹å">èŠ‚ç‚¹å</h2>
<p>RabbitMQèŠ‚ç‚¹é€šè¿‡èŠ‚ç‚¹åæ¥è¯†åˆ«ã€‚ä¸€ä¸ªrabbitmqèŠ‚ç‚¹åŒ…æ‹¬ä¸¤éƒ¨åˆ†ã€‚ä¸€ä¸ªå‰ç¼€ï¼ˆé€šå¸¸æ˜¯rabbitï¼‰å’Œä¸»æœºåã€‚æ¯”å¦‚<code>rabbit@node1.messaging.svc.local</code><br>
é›†ç¾¤ä¸­çš„èŠ‚ç‚¹åå¿…é¡»å”¯ä¸€ã€‚å¦‚æœåœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œäº†å¤šäº†rabbitmqèŠ‚ç‚¹ï¼Œåˆ™è¿™äº›èŠ‚ç‚¹å¿…é¡»è¦ä½¿ç”¨ä¸åŒçš„å‰ç¼€ï¼Œæ¯”å¦‚<code>rabbit1@hostname</code>å’Œ<code>rabbit2@hostname</code> ã€‚<br>
åœ¨é›†ç¾¤ä¸­ï¼ŒèŠ‚ç‚¹é€šè¿‡èŠ‚ç‚¹åæ¥ç›¸äº’è¾¨åˆ«å’Œé€šä¿¡ã€‚è¿™æ„å‘³ç€æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„hostnameéƒ½å¯ä»¥æ­£å¸¸è§£æã€‚rabbitmqå‘½ä»¤è¡Œå·¥å…·ä¹Ÿä½¿ç”¨èŠ‚ç‚¹åæ¥è¾¨åˆ«èŠ‚ç‚¹ã€‚<br>
å½“ä¸€ä¸ªèŠ‚ç‚¹å¯åŠ¨æ—¶ï¼Œå°†ä¼šæ£€æŸ¥æ˜¯å¦è¿™ä¸ªèŠ‚ç‚¹å·²ç»æ³¨å†Œï¼ŒèŠ‚ç‚¹åä¹Ÿå¯ä»¥é€šè¿‡<code>RABBITMQ_NODENAME</code>ç¯å¢ƒå˜é‡è®¾ç½®ã€‚å¦‚æœè¿™ä¸ªå˜é‡æ²¡æœ‰å£°æ˜ï¼Œå°†ä¼šä½¿ç”¨<code>rabbit@hostname</code>çš„æ–¹å¼ã€‚<br>
å¦‚æœç³»ç»Ÿä½¿ç”¨äº†FQDNsï¼ŒRabbitMQèŠ‚ç‚¹å’Œå‘½ä»¤è¡Œå·¥å…·å¿…é¡»è¦é…ç½®ä½¿ç”¨é•¿èŠ‚ç‚¹åç§°ã€‚å¯ä»¥ä½¿ç”¨<code>RABBITMQ_USE_LONGNAME</code>ç¯å¢ƒå˜é‡ä¸º<code>true</code>,åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­ï¼Œé™¤äº†å¯ä»¥é…ç½®<code>RABBITMQ_USE_LONGNAME</code>ç¯å¢ƒå˜é‡æˆ–è€…<code>--longnames</code>å‚æ•°ã€‚</p>
<h2 id="é›†ç¾¤å‘ç°å‰æ">é›†ç¾¤å‘ç°å‰æ</h2>
<h3 id="ä¸»æœºåå¯è§£æ">ä¸»æœºåå¯è§£æ</h3>
<p>å¯ä»¥åœ¨<code>/etc/hosts</code>ä¸­é…ç½®ä¸»æœºåæ¥è§£æä¸»æœºåã€‚æœ‰ä¸€äº›åœºæ™¯ï¼Œä¿®æ”¹hostsæ–‡ä»¶æ˜¯ä¸è¢«å®¹è®¸çš„ã€‚erlangè™šæ‹Ÿæœºå¯ä»¥é…ç½®ä½¿ç”¨å…¶ä»–çš„æ–¹æ³•æ¥è§£æä¸»æœºåï¼Œå¦‚é…ç½®DNSæœåŠ¡å™¨ï¼ŒæŒ‡å®šä¸€ä¸ªæœ¬åœ°çš„æ–‡ä»¶ï¼Œä¸€ä¸ªéæ ‡å‡†hostsæ–‡ä»¶</p>
<h3 id="ç«¯å£å¯è¾¾">ç«¯å£å¯è¾¾</h3>
<p>RabbitMQèŠ‚ç‚¹ç»‘å®šåˆ°TCPç«¯å£æ¥æ¥å—å®¢æˆ·ç«¯å’Œå‘½ä»¤è¡Œå·¥å…·çš„è¿æ¥ã€‚ä¸€äº›è¿›ç¨‹å’Œå·¥å…·å¦‚<code>selinux</code>å¯èƒ½ä¼šé˜»æ­¢RabbitMQç»‘å®šç«¯å£ã€‚å½“ç»‘å®šç«¯å£å¤±è´¥æ—¶ï¼ŒRabbitMQèŠ‚ç‚¹å¯åŠ¨ä¼šå¤±è´¥ã€‚<br>
è¯·ä¿è¯èŠ‚ç‚¹ä¹‹é—´çš„ä¸‹åˆ—ç«¯å£å¯è®¿é—®ï¼š</p>
<ul>
<li>4369 a helper discovery daemon used by RabbitMQ nodes and CLI tools</li>
<li>5672,5671 AMQP 0-9-1 å’Œ1.0 å®¢æˆ·ç«¯è¿æ¥ç«¯å£</li>
<li>25672 èŠ‚ç‚¹ä¹‹é—´é€šä¿¡ç«¯å£</li>
<li>15672 HTTP APIå®¢æˆ·ç«¯ï¼Œç®¡ç†åå°å¯åŠ¨ç«¯å£</li>
<li>61613, 61614  STOMP clients without and with TLS (only if the STOMP plugin is enabled)</li>
<li>1883, 8883: (MQTT clients without and with TLS, if the MQTT plugin is enabled</li>
<li>15674: STOMP-over-WebSockets clients (only if the Web STOMP plugin is enabled)</li>
<li>15675: MQTT-over-WebSockets clients (only if the Web MQTT plugin is enabled)</li>
<li>15692: Prometheus metrics (only if the Prometheus plugin is enabled)</li>
</ul>
<h2 id="é›†ç¾¤èŠ‚ç‚¹">é›†ç¾¤èŠ‚ç‚¹</h2>
<p>ä¸€äº›åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰leaderå’ŒfollowerèŠ‚ç‚¹è§’è‰²ï¼Œåœ¨RabbitMQä¸­æ²¡æœ‰è¿™äº›è§’è‰²ã€‚æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„èŠ‚ç‚¹ã€‚<br>
å‘½ä»¤è¡Œå·¥å…·æˆ–è€…HTTP APIè®¿é—®ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ã€‚<br>
RabbitMQèŠ‚ç‚¹å’Œå‘½ä»¤è¡Œå·¥å…·ï¼ˆå¦‚rabbitmqctlï¼‰ä½¿ç”¨ä¸€ä¸ªcookieæ¥å†³å®šæ˜¯å¦ä»–ä»¬å¯ä»¥ç›¸äº’é€šä¿¡ã€‚ä¸¤ä¸ªèŠ‚ç‚¹åªæœ‰cookieä¸€è‡´æ‰èƒ½æ­£å¸¸é€šä¿¡ã€‚cookieæ˜¯ä¸€æ®µéšæœºå­—æ¯æ•°å­—å­—ç¬¦ä¸²ï¼Œå­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶çš„æƒé™ä¹Ÿè¦æ§åˆ¶ï¼Œå¦‚è®¾ç½®ä¸º400æˆ–è€…600ã€‚<br>
å¦‚æœè¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒErlangè™šæ‹Ÿæœºå°†ä¼šåœ¨rabbitmqå¯åŠ¨çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªã€‚<br>
cookieæ–‡ä»¶è·¯å¾„<br>
linuxã€MacOSã€*BSDï¼š/var/lib/rabbitmq/.erlang.cookie</p>
<h3 id="èŠ‚ç‚¹æ•°é‡">èŠ‚ç‚¹æ•°é‡</h3>
<p>é›†ç¾¤ä¸­çš„æ•°é‡æœ€å¥½ä¸ºå¥‡æ•°ä¸ªï¼š1ï¼Œ3ï¼Œ5ç­‰ç­‰<br>
ä¸¤ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤æä¸æ¨è</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Django-rest-framework]]></title>
        <id>https://mrpingan.github.io/post/django-rest-framework</id>
        <link href="https://mrpingan.github.io/post/django-rest-framework">
        </link>
        <updated>2020-01-08T13:48:44.000Z</updated>
        <content type="html"><![CDATA[<p>1ã€æµè§ˆå™¨apiç•Œé¢æ²¡æœ‰LoginæŒ‰é’®</p>
<pre><code class="language-python">urlpatterns = [
    path('^api-auth/',include('rest_framework.urls',namespace=&quot;rest_framework_auth&quot;))
]
</code></pre>
<p>éœ€è¦åœ¨<code>urls.py</code>ä¸­é…ç½®è¿™ä¸€æ¡è·¯ç”±ï¼Œå°±å¯ä»¥çœ‹åˆ°ç™»å½•æŒ‰é’®äº†<br>
<img src="https://mrpingan.github.io/post-images/1578491545380.png" alt=""></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¥½æ–‡ä¸€è§ˆ]]></title>
        <id>https://mrpingan.github.io/post/hao-wen-yi-lan</id>
        <link href="https://mrpingan.github.io/post/hao-wen-yi-lan">
        </link>
        <updated>2019-12-27T14:15:42.000Z</updated>
        <content type="html"><![CDATA[<p>djangoæºç è§£è¯»ï¼š<br>
http://www.ziawang.com/article/302/#<br>
http://www.ziawang.com/blog/django/<br>
http://www.ziawang.com/article/169/</p>
<p>erpå¼€æºé¡¹ç›®ï¼š<br>
https://sourcegraph.com/github.com/zhuinfo/Django-ERP/-/blob/plugin/wfusers.py</p>
<p>ç«™ç‚¹ï¼š<br>
http://devopstarter.info/page/9/</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[javaé¡¹ç›®ssl è¯ä¹¦éªŒè¯é”™è¯¯]]></title>
        <id>https://mrpingan.github.io/post/java-xiang-mu-ssl-zheng-shu-yan-zheng-cuo-wu</id>
        <link href="https://mrpingan.github.io/post/java-xiang-mu-ssl-zheng-shu-yan-zheng-cuo-wu">
        </link>
        <updated>2019-11-20T12:38:49.000Z</updated>
        <content type="html"><![CDATA[<p>åœ¨java1.7çš„é¡¹ç›®ä¸­å¯åŠ¨javaé¡¹ç›®é…ç½®äº†sslï¼ŒæŠ¥äº†å¦‚ä¸‹é”™è¯¯</p>
<pre><code>sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
	at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:385)
	at sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:292)
	at sun.security.validator.Validator.validate(Validator.java:260)
	at sun.security.ssl.X509TrustManagerImpl.validate(X509TrustManagerImpl.java:326)
	at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:231)
	at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:126)
	at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1428)
	at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:209)
	at sun.security.ssl.Handshaker.processLoop(Handshaker.java:913)
	at sun.security.ssl.Handshaker.process_record(Handshaker.java:849)
	at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1023)
	at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1332)
	at sun.security.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:709)
	at sun.security.ssl.AppOutputStream.write(AppOutputStream.java:122)
	at sun.security.ssl.AppOutputStream.write(AppOutputStream.java:136)
	at SSLPoke.main(SSLPoke.java:31)
Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
	at sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:196)
	at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:268)
	at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:380)
	... 15 more
</code></pre>
<p>è™½ç„¶æˆ‘ç”³è¯·çš„è¯ä¹¦æ˜¯æƒå¨æœºæ„è®¤è¯çš„CAã€‚è¿™ä¸ªé”™è¯¯æŒ‡çš„æ˜¯è¯ä¹¦ä¸è¢«éªŒè¯ï¼Œå¯èƒ½æœ‰å¦‚ä¸‹åŸå› ï¼š</p>
<ul>
<li>è¯ä¹¦æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œéœ€è¦åœ¨keystoreä¸­å¯¼å…¥è‡ªç­¾åçš„CA</li>
<li>&lt;JAVA_HOME&gt;/jre/lib/security/cacertsæ–‡ä»¶å¤ªæ—§ï¼Œæ²¡æœ‰åŒ…å«æœ€æ–°çš„CA</li>
<li>è¯ä¹¦é”™è¯¯</li>
</ul>
<p>é’ˆå¯¹å‰ä¸¤ç§é”™è¯¯ï¼Œéœ€è¦æŠŠè¯ä¹¦å¯¼å…¥åˆ°keystoreä¸­</p>
<h2 id="å¯¼å…¥è¯ä¹¦åˆ°keystoreä¸­">å¯¼å…¥è¯ä¹¦åˆ°keystoreä¸­</h2>
<h3 id="å‘½ä»¤è¡Œå¯¼å‡ºè¯ä¹¦">å‘½ä»¤è¡Œå¯¼å‡ºè¯ä¹¦</h3>
<p>Unix(éœ€è¦æŠŠgoogle.comæ”¹æˆè‡ªå·±å¯¹åº”çš„åŸŸå):</p>
<pre><code>openssl s_client -connect google.com:443 -servername google.com:443 &lt; /dev/null | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; public.crt
</code></pre>
<p>windowsï¼š</p>
<pre><code>openssl s_client -connect google.com:443 -servername google.com:443 &lt; NUL | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; public.crt
</code></pre>
<h3 id="å¯¼å…¥è¯ä¹¦åˆ°keystore">å¯¼å…¥è¯ä¹¦åˆ°keystore</h3>
<pre><code>&lt;JAVA_HOME&gt;/bin/keytool -import -alias &lt;server_name&gt; -keystore &lt;JAVA_HOME&gt;/jre/lib/security/cacerts -file public.crt
</code></pre>
<p>å‚è€ƒæ–‡æ¡£ï¼š<br>
https://confluence.atlassian.com/kb/how-to-import-a-public-ssl-certificate-into-a-jvm-867025849.html#HowtoimportapublicSSLcertificateintoaJVM-commandline</p>
<p>https://confluence.atlassian.com/kb/unable-to-connect-to-ssl-services-due-to-pkix-path-building-failed-error-779355358.html</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ubuntu å®‰è£…é—®é¢˜]]></title>
        <id>https://mrpingan.github.io/post/ubuntu-an-zhuang-wen-ti</id>
        <link href="https://mrpingan.github.io/post/ubuntu-an-zhuang-wen-ti">
        </link>
        <updated>2019-11-11T11:55:22.000Z</updated>
        <content type="html"><![CDATA[<p>é—®é¢˜ç‰‡æ®µ</p>
<pre><code>sh: 0: getcwd() failed: No such file or directory
sh: 0: getcwd() failed: No such file or directory
sh: 0: getcwd() failed: No such file or directory
sh: 0: getcwd() failed: No such file or directory
sh: 0: getcwd() failed: No such file or directory
sh: 0: getcwd() failed: No such file or directory
sh: 0: getcwd() failed: No such file or directory
</code></pre>
<p>è§£å†³ï¼š</p>
<ul>
<li>åˆ°rootç›®å½•ä¸‹åŒºæ‰§è¡Œå‘½ä»¤</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[openldap é…ç½®mirrormode]]></title>
        <id>https://mrpingan.github.io/post/openldap-pei-zhi-mirrormode</id>
        <link href="https://mrpingan.github.io/post/openldap-pei-zhi-mirrormode">
        </link>
        <updated>2019-11-08T03:28:40.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹">ç®€ä»‹</h1>
<p>MirrorMode æ¨¡å¼é•œåƒåŒæ­¥æ¨¡å¼ï¼Œè€Œä¸”ä¸»æœåŠ¡å™¨äº’ç›¸ä»¥æ¨çš„æ–¹å¼å®ç°ç›®å½•æ ‘æ¡ç›®åŒæ­¥ï¼Œæœ€å¤šå…è®¸ä¸”ä¸¤å°æœºå™¨ä¸ºä¸»æœåŠ¡å™¨ã€‚å¦‚æœè¦æ·»åŠ æ›´å¤šèŠ‚ç‚¹ï¼Œæ­¤æ—¶åªèƒ½æ·»åŠ å¤šå°ä»æœåŠ¡å™¨ï¼Œè€Œä¸èƒ½å°†æ·»åŠ çš„èŠ‚ç‚¹é…ç½®ä¸ºä¸»æœåŠ¡å™¨</p>
<h1 id="å‡†å¤‡">å‡†å¤‡</h1>
<table>
<thead>
<tr>
<th>ç”¨é€”</th>
<th>IP</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>provider1</td>
<td>192.168.33.10</td>
<td></td>
</tr>
<tr>
<td>provider2</td>
<td>192.168.33.11</td>
<td></td>
</tr>
</tbody>
</table>
<p>ä¸¤å°æœåŠ¡å™¨äº’ä¸ºä¸»å¤‡ï¼Œä½†æ˜¯åªèƒ½åœ¨ä¸€ä¸ªproviderä¸Šå†™ã€‚</p>
<h1 id="å®‰è£…ldap">å®‰è£…ldap</h1>
<pre><code>apt install slapd ldap-utils

#é‡æ–°é…ç½®
dpkg-reconfigure slapd
</code></pre>
<p>dn: dc=ping,dc=cn<br>
ç®¡ç†å‘˜å¯†ç ï¼šadmin</p>
<p>ä¸¤å°æœåŠ¡å™¨çš„DITè¦ä¿æŒä¸€è‡´</p>
<h1 id="å¼€å¯æ—¥å¿—å¦‚æœå·²å¼€å¯å¯å¿½ç•¥">å¼€å¯æ—¥å¿—(å¦‚æœå·²å¼€å¯å¯å¿½ç•¥)</h1>
<p>log.ldifæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code>dn: cn=config
changetype: modify
replace: olcLogLevel
olcLogLevel: stats sync
</code></pre>
<p>åº”ç”¨é…ç½®ï¼š</p>
<pre><code>ldapmodify -Y EXTERNAL -H ldapi:/// -f log.ldif
</code></pre>
<h1 id="åŠ è½½syncprovæ¨¡å—">åŠ è½½syncprovæ¨¡å—</h1>
<p>sync.ldifæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code>dn: cn=module{0},cn=config
changetype: modify
add: olcModuleLoad
olcModuleLoad: syncprov.la

dn: olcOverlay=syncprov,olcDatabase={1}hdb,cn=config
changetype: add
objectClass: olcOverlayConfig
objectClass: olcSyncProvConfig
olcOverlay: syncprov
olcSpCheckpoint: 100 10
olcSpSessionLog: 100
</code></pre>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>æŒ‡å®šçš„dnå­˜åœ¨</li>
<li>æŒ‡å®šçš„Databaseè¦å­˜åœ¨</li>
<li>æ¨¡å—æ–‡ä»¶å­˜åœ¨ï¼Œubuntu çš„æ¨¡å—ç›®å½•ä¸€èˆ¬åœ¨<code>/usr/lib/ldap</code>ç›®å½•ä¸‹,å¦‚æœåœ¨å…¶ä»–ç›®å½•ä¸‹ï¼Œå¯é€šè¿‡<code>olcModulePath</code>æŒ‡å®šç›®å½•ï¼Œä¹Ÿå¯æŸ¥çœ‹<code>cn=module{0}.ldif</code>æ–‡ä»¶<code>olcModulePath</code>æ˜¯å¦è¢«æŒ‡å®š</li>
</ul>
<p>åº”ç”¨é…ç½®ï¼š</p>
<pre><code>ldapmodify -Y EXTERNAL -H ldapi:/// -f sync.ldif
</code></pre>
<h1 id="é…ç½®mirroræ¨¡å¼">é…ç½®mirroræ¨¡å¼</h1>
<p>master01.ldifæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š<br>
master01çš„ipåœ°å€ä¸º: <code>192.168.33.10</code></p>
<pre><code>dn: cn=config
changetype: modify
replace: olcServerID
olcServerID: 1

dn: olcDatabase={1}hdb,cn=config
changetype: modify
replace: olcSyncRepl
olcSyncRepl: rid=001
             provider=ldap://192.168.33.11:389
             bindmethod=simple
             binddn=&quot;cn=admin,dc=ping,dc=cn&quot;
             credentials=admin
             searchbase=&quot;dc=ping,dc=cn&quot;
             filter=&quot;(objectClass=*)&quot;
             scope=sub
             schemachecking=off
             attrs=&quot;*,+&quot;
             type=refreshAndPersist
             retry=&quot;5 5 300 +&quot;
             interval=00:00:01:00
-
add: olcMirrorMode
olcMirrorMode: TRUE
-
add: olcDbIndex
olcDbIndex: entryUUID eq
-
add: olcDbIndex
olcDbIndex: entryCSN eq
</code></pre>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>æ­¤å¤„çš„<code>provider</code>æŒ‡å®šçš„å¦ä¸€å°æœåŠ¡å™¨çš„ip</li>
<li><code>rid</code>è¦ä¿æŒä¸€è‡´</li>
<li><code>olcServerID</code>è¦åŒºåˆ†</li>
</ul>
<p>åº”ç”¨é…ç½®ï¼š</p>
<pre><code>ldapmodify -Y EXTERNAL -H ldapi:/// -f master01.ldif
</code></pre>
<p>master02.ldifæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code>dn: cn=config
changetype: modify
replace: olcServerID
olcServerID: 2

dn: olcDatabase={1}hdb,cn=config
changetype: modify
replace: olcSyncRepl
olcSyncRepl: rid=001
             provider=ldap://192.168.33.10:389
             bindmethod=simple
             binddn=&quot;cn=admin,dc=ping,dc=cn&quot;
             credentials=admin
             searchbase=&quot;dc=ping,dc=cn&quot;
             filter=&quot;(objectClass=*)&quot;
             scope=sub
             schemachecking=off
             attrs=&quot;*,+&quot;
             type=refreshAndPersist
             retry=&quot;5 5 300 +&quot;
             interval=00:00:01:00
-
add: olcMirrorMode
olcMirrorMode: TRUE
-
add: olcDbIndex
olcDbIndex: entryUUID eq
-
add: olcDbIndex
olcDbIndex: entryCSN eq
</code></pre>
<p>åº”ç”¨é…ç½®:</p>
<pre><code>ldapmodify -Y EXTERNAL -H ldapi:/// -f master02.ldif
</code></pre>
<h1 id="éªŒè¯">éªŒè¯</h1>
<p>1ã€æŸ¥çœ‹æ—¥å¿—ï¼š<br>
<img src="https://mrpingan.github.io/post-images/1573189656518.png" alt=""><br>
å¹¶æœªçœ‹åˆ°ä»»ä½•é”™è¯¯</p>
<p>2ã€æ·»åŠ ç”¨æˆ·<br>
åœ¨master01ä¸Šæ·»åŠ ç”¨æˆ·ï¼Œçœ‹master02ä¸Šæ˜¯å¦è¢«åŒæ­¥</p>
<p>éªŒè¯é€šè¿‡ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ubuntu14å®‰è£…FPM]]></title>
        <id>https://mrpingan.github.io/post/ubuntu14-an-zhuang-fpm</id>
        <link href="https://mrpingan.github.io/post/ubuntu14-an-zhuang-fpm">
        </link>
        <updated>2019-09-16T08:43:52.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ä»‹ç»">ä»‹ç»</h1>
<p>ä¸åŒçš„linuxå‘è¡Œç‰ˆéƒ½æœ‰ä¸åŒçš„åŒ…ç®¡ç†å·¥å…·ã€‚ä¾‹å¦‚ï¼ŒFedoraå’ŒRedhatéƒ½ä½¿ç”¨<code>.rpm</code>æ ¼å¼çš„åŒ…ï¼ŒDebianå’ŒUbuntuä½¿ç”¨<code>.deb</code>æ ¼å¼çš„åŒ…ã€‚è¿™äº›åŒ…æ˜¯ä¸å…¼å®¹çš„ï¼Œè€Œä¸”è¦ç†Ÿæ‚‰åˆ›å»ºä¸åŒåŒ…çš„æ–¹å¼ä¹Ÿå¾ˆè´¹æ—¶é—´ã€‚<br>
ä¸ºäº†æœ€å°åŒ–åˆ›å»ºåŒ…çš„å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>fpm</code>å·¥å…·ã€‚ä½¿ç”¨<code>fpm</code>,ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„åŒæ—¶åˆ›å»º<code>.rpm</code>å’Œ<code>.deb</code>æ–‡ä»¶ã€‚æ˜¯ä¸æ˜¯å¾ˆé…·ï¼ä¸‹é¢åœ¨<code>ubuntu 14</code>çš„ç¯å¢ƒæ¼”ç¤ºã€‚</p>
<h1 id="å®‰è£…fpm">å®‰è£…fpm</h1>
<p>fpmæ˜¯rubyè¯­è¨€å†™çš„å·¥å…·ï¼Œæ‰€ä»¥è¦å®‰è£…rubyç¯å¢ƒ</p>
<pre><code>apt-get update
apt-get install ruby-dev build-essential
</code></pre>
<p>æŸ¥çœ‹rubyç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬ä½äº2.0ï¼Œå®‰è£…fpm1.11.0çš„è¿‡ç¨‹ä¸­å°†ä¼šæŠ¥é”™</p>
<pre><code>ruby -v
</code></pre>
<p>å®‰è£…fpm</p>
<pre><code>gem install fpm
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œæ£€éªŒfpm</p>
<pre><code>fpm -help
</code></pre>
<pre><code>Intro:

  This is fpm version 1.11.0

  If you think something is wrong, it's probably a bug! :)
  Please file these here: https://github.com/jordansissel/fpm/issues

  You can find support on irc (#fpm on freenode irc) or via email with
  fpm-users@googlegroups.com

Loaded package types:
...
</code></pre>
<h2 id="å¦‚æœrubyç‰ˆæœ¬ä½äº20">å¦‚æœrubyç‰ˆæœ¬ä½äº2.0</h2>
<p>å¦‚æœrubyç‰ˆæœ¬ä½äº2.0ï¼Œéœ€è¦å®‰è£…é«˜ç‰ˆæœ¬rubyã€‚æˆ‘ä»¬ä½¿ç”¨<code>rvm</code>å·¥å…·å»å®‰è£…rubyé«˜ç‰ˆæœ¬</p>
<h3 id="å®‰è£…rvm">å®‰è£…rvm</h3>
<p>å‚è€ƒrvmåœ°å€ï¼š<a href="http://rvm.io/">rvmå®˜ç½‘</a><br>
å®‰è£…gpg2å‘½ä»¤</p>
<pre><code>apt-get install gnupg2
</code></pre>
<p>å®‰è£…GPG 2å…¬é’¥</p>
<pre><code>gpg2 --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB
</code></pre>
<p>å®‰è£…rvm</p>
<pre><code>\curl -sSL https://get.rvm.io | bash -s stable
</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code>Downloading https://github.com/rvm/rvm/archive/1.29.9.tar.gz
Downloading https://github.com/rvm/rvm/releases/download/1.29.9/1.29.9.tar.gz.asc
gpg: Signature made Wed 10 Jul 2019 08:31:02 AM UTC using RSA key ID 39499BDB
gpg: Good signature from &quot;Piotr Kuczynski &lt;piotr.kuczynski@gmail.com&gt;&quot;
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: 7D2B AF1C F37B 13E2 069D  6956 105B D0E7 3949 9BDB
GPG verified '/usr/local/rvm/archives/rvm-1.29.9.tgz'
Creating group 'rvm'
Installing RVM to /usr/local/rvm/
Installation of RVM in /usr/local/rvm/ is almost complete:

  * First you need to add all users that will be using rvm to 'rvm' group,
    and logout - login again, anyone using rvm will be operating with `umask u=rwx,g=rwx,o=rx`.

  * To start using RVM you need to run `source /etc/profile.d/rvm.sh`
    in all your open shell windows, in rare cases you need to reopen all shell windows.
  * Please do NOT forget to add your users to the rvm group.
     The installer no longer auto-adds root or users to the rvm group. Admins must do this.
     Also, please note that group memberships are ONLY evaluated at login time.
     This means that users must log out then back in before group membership takes effect!
Thanks for installing RVM ğŸ™
Please consider donating to our open collective to help us maintain RVM.

ğŸ‘‰  Donate: https://opencollective.com/rvm/donate
</code></pre>
<p>åŠ è½½ç¯å¢ƒå˜é‡</p>
<pre><code>source /usr/local/rvm/scripts/rvm
</code></pre>
<p>ç°åœ¨å¯ä»¥ä½¿ç”¨rvmå‘½ä»¤äº†,æŸ¥çœ‹å¯å®‰è£…çš„rubyç‰ˆæœ¬</p>
<pre><code>rvm list known
</code></pre>
<p>å®‰è£…ruby 2.3</p>
<pre><code>rvm install 2.3
</code></pre>
<p>å†é€šè¿‡<code>ruby -v</code>æŸ¥çœ‹ç‰ˆæœ¬æ˜¯å¦å˜ä¸º2.3</p>
<h1 id="ç†Ÿæ‚‰fpmåŸºæœ¬åŠŸèƒ½">ç†Ÿæ‚‰fpmåŸºæœ¬åŠŸèƒ½</h1>
<p>fpm å‘½ä»¤è¡Œçš„åŸºæœ¬æ ¼å¼</p>
<pre><code>fpm -s source_type -t target_type source_name_or_location
</code></pre>
<h2 id="æŠŠä¸€ä¸ªgemåŒ…è½¬å˜ä¸ºdebåŒ…">æŠŠä¸€ä¸ªgemåŒ…è½¬å˜ä¸ºdebåŒ…</h2>
<p>bundleræ˜¯ä¸€ä¸ªå¸¸è§çš„gemåŒ…</p>
<pre><code>fpm -s gem -t deb bundler
</code></pre>
<pre><code>Debian packaging tools generally labels all files in /etc as config files, as mandated by policy, so fpm defaults to this behavior for deb packages. You can disable this default behavior with --deb-no-default-config-files flag {:level=&gt;:warn}
Created package {:path=&gt;&quot;rubygem-bundler_2.0.2_all.deb&quot;}
</code></pre>
<p>å†å½“å‰ç›®å½•å°±å¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†<code>rubygem-bundler_2.0.2_all.deb</code>å®‰è£…åŒ…<br>
çœ‹çœ‹å®‰è£…ä¼šä¸ä¼šæœ‰é—®é¢˜<br>
æŸ¥çœ‹å½“å‰çš„gemåˆ—è¡¨</p>
<pre><code>root@client:~# gem list

*** LOCAL GEMS ***

arr-pm (0.0.10)
backports (3.15.0)
bigdecimal (default: 1.2.8)
bundler (default: 1.16.2)
bundler-unload (1.0.2)
cabin (0.9.0)
childprocess (0.9.0)
clamp (1.0.1)
did_you_mean (1.0.0)
dotenv (2.7.5)
executable-hooks (1.5.0)
ffi (1.11.1)
fpm (1.11.0)
gem-wrappers (1.4.0)
insist (1.0.0)
io-console (default: 0.4.5)
io-like (0.3.0)
...
</code></pre>
<p>å¯ä»¥çœ‹åˆ°bundlerçš„ç‰ˆæœ¬æ˜¯1.16.2ï¼Œæˆ‘ä»¬æ‰“åŒ…çš„ç‰ˆæœ¬æ˜¯2.0.2<br>
å®‰è£…bundler</p>
<pre><code>dpkg -i rubygem-bundler_2.0.2_all.deb
</code></pre>
<p>å†æ¬¡æŸ¥çœ‹gemå®‰è£…åˆ—è¡¨</p>
<pre><code>root@client:~# gem list

*** LOCAL GEMS ***

arr-pm (0.0.10)
backports (3.15.0)
bigdecimal (default: 1.2.8)
bundler (2.0.2, default: 1.16.2)
bundler-unload (1.0.2)
cabin (0.9.0)
childprocess (0.9.0)
clamp (1.0.1)
did_you_mean (1.0.0)
dotenv (2.7.5)
executable-hooks (1.5.0)
ffi (1.11.1)
fpm (1.11.0)
...
</code></pre>
<p>çœ‹åˆ°bundlerçš„ç‰ˆæœ¬å˜ä¸º2.0.2äº†ã€‚<br>
è¿™æ˜¯æŠŠgemåŒ…è½¬å˜ä¸ºdebåŒ…ï¼Œå±äºåŒ…ç±»å‹ä¹‹é—´çš„è½¬æ¢</p>
<h1 id="æºæ ¼å¼å’Œç›®æ ‡æ ¼å¼">æºæ ¼å¼å’Œç›®æ ‡æ ¼å¼</h1>
<p>fpmæ”¯æŒä¸‹é¢çš„æºæ ¼å¼:<br>
dirã€tarã€gemã€pythonã€pearã€cpanã€zipã€npmã€osxpkgã€emptyã€debã€rpm</p>
<p>æ”¯æŒçš„ç›®æ ‡æ ¼å¼ï¼š<br>
debã€rpmã€zipã€tarã€dirã€shã€osxpkgã€solarisã€pkginã€puppet</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æŸ¥çœ‹å‘è¡Œç‰ˆç‰ˆæœ¬]]></title>
        <id>https://mrpingan.github.io/post/cha-kan-fa-xing-ban-ban-ben</id>
        <link href="https://mrpingan.github.io/post/cha-kan-fa-xing-ban-ban-ben">
        </link>
        <updated>2019-09-16T08:25:02.000Z</updated>
        <content type="html"><![CDATA[<p>åœ¨centoså’Œubuntuä¸Šéƒ½å¯ä»¥é€šè¿‡è¿™æ¡å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬</p>
<pre><code>cat /etc/*-release
</code></pre>
]]></content>
    </entry>
</feed>